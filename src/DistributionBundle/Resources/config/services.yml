services:
    _defaults:
        autowire: true
        autoconfigure: true
        public: false

    DistributionBundle\Controller\:
        resource: '../../Controller'
        public: true
        tags: [ 'app.controller' ]

    DistributionBundle\Utils\:
        resource: '../../Utils'
        public: true

    DistributionBundle\Extension\BeneficiaryGenderExtension:
        tags:
            - { name: twig.extension }

    DistributionBundle\Mapper\:
        resource: '../../Mapper'
        public: true

#######################################################################################
##                                       CRUD                                        ##
#######################################################################################

# TODO: mergefix
    DistributionBundle\Utils\AssistanceService:
        public: true
        arguments:
            - '@doctrine.orm.entity_manager'
            - '@serializer'
            - '@validator'
            - '@CommonBundle\Utils\LocationService'
            - '@distribution.commodity_service'
            - '@distribution.configuration_loader'
            - '@DistributionBundle\Utils\CriteriaAssistanceService'
            - '@transformer.selection_criterion_field'
            - '%distribution.retriever%'
            - '@service_container'

    distribution.configuration_loader:
        alias: DistributionBundle\Utils\ConfigurationLoader
        public: true

    DistributionBundle\Utils\ConfigurationLoader:
        arguments:
            - '@doctrine.orm.entity_manager'
            - '%distribution.criteria%'

    distribution.commodity_service:
        alias: DistributionBundle\Utils\CommodityService
        public: true

#######################################################################################
##                                       CSV                                         ##
#######################################################################################

    DistributionBundle\Export\SmartcardExport:
        arguments:
            - '@CommonBundle\Utils\ExportService'
            - '@doctrine.orm.entity_manager'
            - '@templating'
            - '@pdf_service'

    distribution.export.smartcard:
        alias: DistributionBundle\Export\SmartcardExport
        public: true

    distribution.export.smartcard_invoice:
        class: DistributionBundle\Export\SmartcardInvoiceExport
        public: true
